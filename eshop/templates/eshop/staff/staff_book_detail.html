{% extends 'base.html' %}

{% block content %}
<div class="book-detail-container">
    <div class="book-detail-header">
        <h1>üìò Detail knihy</h1>
        <div class="book-actions">
            {% if perms.eshop.change_book %}
            <a class="btn btn-edit" href="{% url 'book_update' book.id %}?next={{ request.path }}">Upravit</a>
            {% endif %}
            {% if perms.eshop.delete_book %}
            <a class="btn btn-delete" href="{% url 'book_delete' book.id %}?next={{ request.path }}">Smazat</a>
            {% endif %}
            {% if user.is_authenticated and user.is_superuser or user.is_staff %}
            <a class="btn btn-back" href="{% url 'staff_book_list' %}">Zpƒõt</a>
            {% endif %}
        </div>
    </div>

    <div class="book-info">
        <div><strong>N√°zev:</strong> {{ book.name }}</div>
        <div><strong>Popis:</strong> {{ book.description }}</div>
        <div><strong>Cena:</strong> {{ book.price }} Kƒç</div>
        <div><strong>Na skladƒõ:</strong> {{ book.stock_quantity }}</div>
        <div><strong>ISBN:</strong> {{ book.isbn }}</div>
        <div><strong>EAN:</strong> {{ book.ean }}</div>
    </div>

    <div class="book-authors">
        <h3>Auto≈ôi knihy
            {% if perms.eshop.add_autor and perms.eshop.change_book %}
            <a class="btn btn-small" href="{% url 'add_or_create_author' book.id %}">+ Autor</a>
            {% endif %}
        </h3>
        {% for author in book.autor.all %}
        <div class="author-item">
            {{ author.name }} {{ author.lastname }}
            {% if perms.eshop.change_book %}
            <a href="{% url 'remove_author' book.id author.id %}?next={{ request.path }}">Odebrat ‚ùå</a>
            {% endif %}
            {% if perms.eshop.change_autor %}
            <a href="{% url 'author_update' author.id %}?next={{ request.path }}">Upravit ‚úèÔ∏è</a>
            {% endif %}
        </div>
        {% empty %}
        <p>≈Ω√°dn√Ω autor u t√©to knihy</p>
        {% endfor %}
    </div>

    <div class="book-categories">
        <h3>Kategorie knihy</h3>
        {% for category in book.category.all %}
        <div>{{ category.name }}</div>
        {% empty %}
        <p>≈Ω√°dn√° kategorie</p>
        {% endfor %}
    </div>

    <div class="book-images">
        <h3>Obr√°zky
            {% if perms.eshop.add_image %}
            <a class="btn btn-small" href="{% url 'add_image' book.id %}">+ Obr√°zek</a>
            {% endif %}
        </h3>
        <div class="image-gallery">
            {% for image in book.images.all %}
            <div class="image-card">
                <img src="{{ image.image.url }}" alt="" class="book-image">
                <div>
                    {% if perms.eshop.delete_image %}
                    <a class="btn btn-small" href="{% url 'image_delete' image.id %}?next={{ request.path }}">Smazat
                        ‚ùå</a>
                    {% endif %}
                    {% if perms.eshop.change_image %}
                    <a class="btn btn-small" href="{% url 'image_update' book.id image.id %}?next={{ request.path }}">Upravit
                        ‚úèÔ∏è</a>
                    {% endif %}
                </div>
            </div>
            {% empty %}
            <p>≈Ω√°dn√Ω obr√°zek</p>
            {% endfor %}
        </div>
    </div>
</div>
{% endblock %}
